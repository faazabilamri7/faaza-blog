---
import { Icon } from 'astro-icon/components';

export interface Props {
  text: string;
  url: string | URL;
  class?: string;
}

const { text, url, class: className = 'inline-block' } = Astro.props;

const shareUrl = typeof url === 'string' ? url : url.href;
const encodedUrl = encodeURIComponent(shareUrl);
const encodedText = encodeURIComponent(text);

// UTM parameters
const utmParams = '?utm_source=website&utm_medium=social&utm_campaign=share';
const fullUrl = shareUrl + utmParams;

// Platform-specific URLs
const twitterUrl = `https://twitter.com/intent/tweet?url=${encodeURIComponent(fullUrl)}&text=${encodedText}`;
const facebookUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(fullUrl)}`;
const linkedinUrl = `https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(fullUrl)}`;
const whatsappUrl = `https://wa.me/?text=${encodedText}%20${encodeURIComponent(fullUrl)}`;
const emailUrl = `mailto:?subject=${encodedText}&body=${encodeURIComponent(fullUrl)}`;
---

<div class={className}>
  <span class="align-super font-bold text-slate-500 dark:text-slate-400">Share:</span>
  <a
    href={twitterUrl}
    target="_blank"
    rel="noopener noreferrer"
    class="ml-2 rtl:ml-0 rtl:mr-2 inline-block"
    title="Share on Twitter"
    ><Icon
      name="tabler:brand-x"
      class="w-6 h-6 text-gray-400 dark:text-slate-500 hover:text-black dark:hover:text-slate-300"
    />
  </a>
  <a
    href={facebookUrl}
    target="_blank"
    rel="noopener noreferrer"
    class="ml-2 rtl:ml-0 rtl:mr-2 inline-block"
    title="Share on Facebook"
    ><Icon
      name="tabler:brand-facebook"
      class="w-6 h-6 text-gray-400 dark:text-slate-500 hover:text-black dark:hover:text-slate-300"
    />
  </a>
  <a
    href={linkedinUrl}
    target="_blank"
    rel="noopener noreferrer"
    class="ml-2 rtl:ml-0 rtl:mr-2 inline-block"
    title="Share on LinkedIn"
    ><Icon
      name="tabler:brand-linkedin"
      class="w-6 h-6 text-gray-400 dark:text-slate-500 hover:text-black dark:hover:text-slate-300"
    />
  </a>
  <a
    href={whatsappUrl}
    target="_blank"
    rel="noopener noreferrer"
    class="ml-2 rtl:ml-0 rtl:mr-2 inline-block"
    title="Share on WhatsApp"
    ><Icon
      name="tabler:brand-whatsapp"
      class="w-6 h-6 text-gray-400 dark:text-slate-500 hover:text-black dark:hover:text-slate-300"
    />
  </a>
  <a
    href={emailUrl}
    class="ml-2 rtl:ml-0 rtl:mr-2 inline-block"
    title="Share via Email"
    ><Icon
      name="tabler:mail"
      class="w-6 h-6 text-gray-400 dark:text-slate-500 hover:text-black dark:hover:text-slate-300"
    />
  </a>
</div>
